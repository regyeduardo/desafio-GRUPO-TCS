{% extends 'base.html' %}
{% block title %} Dashboard {% endblock %}
{% load static %}
{% block style %}
<style>
    * {
        list-style-type: none
    }
</style>
{% endblock %}

{% block body %}

<nav class="navbar navbar-light bg-light">
    <div class="container">
        <a class="navbar-brand" href="https://github.com/regyeduardo" target="_blank">Regy</a>
        <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownMenuLink" role="button" data-toggle="dropdown"
            aria-expanded="false">
            {{ user }}
            </a>
            <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
                <a class="dropdown-item" href="{% url 'login:logout' %}">Sair</a>
            </div>
        </li>
    </div>
</nav>

<div class="container">

    {% if messages %}
        {% for message in messages %}
            {% if message.level %}
                <div class="alert alert-{{ message.tags }} " role="alert">
                    {{ message }}
                    <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
            {% endif %}
        {% endfor %}
    {% endif %}
    <div class="row">
        <div class="col-sm">
            <div class="card">
                <div class="card-body">
                    <h5>Frequência de Eventos</h5>
                    <form class="form-row" action="" method="post">
                        <div class="col">
                            <!-- <div class="form-group"> -->
                                <input type="number" name="period" min=0 max=55 value="0" required>
                            <!-- </div> -->
                            <button class="btn btn-outline-info my-2 my-sm-0" type="submit">Definir</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
    <div class="row mb-4">
        <div class="col-sm">
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">Status</h5>
    
                    {% if all_status %}
                    <form action="" method="post">
                        <input type="hidden" name="_method" value="PUT">
                        <input type="hidden" name="_model_class" value="status">
                        <div class="table-responsive">
                            <table class="table table-borderless table-hover table-sm">
                                <caption>
                                    <button class="btn btn-primary botao-criar botao-caption status">Criar</button>
                                </caption>
                                <thead>
                                    <tr>
                                        <th scope="col">Código</th>
                                        <th scope="col">Nome</th>
                                        <th scope="col">Ação</th>
                                    </tr>
                                </thead>
                                <tbody>
    
                                    {% for status in all_status %}
                                    <tr>
                                        <input type="hidden" class="hidden_id" name="_id" value="{{ status.id }}" disabled>
                                        <td>
                                            <div class="input-group">
                                                <input type="text" class="form-control" name="codigo"
                                                    curvalue="{{ status.codigo }}" value="{{ status.codigo }}"
                                                    disabled="">
                                                <span class="input-group-append">
                                                    <i class="input-group-text bi bi-pencil-square"></i>
                                                </span>
                                            </div>
                                        </td>
    
                                        <td>
                                            <div class="input-group">
                                                <input type="text" class="form-control" name="nome"
                                                    curvalue="{{ status.nome }}" value="{{ status.nome }}" disabled>
                                                <span class="input-group-append">
                                                    <i class="input-group-text bi bi-pencil-square"></i>
                                                </span>
                                            </div>
                                        </td>
    
                                        <td>
                                            <button class="btn btn-danger botao-apagar w-100 {{ status.id }}">Apagar</button>
                                        </td>
                                    </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    </form>
                    {% else %}
                    <form action="" method="post">
                        <input type="hidden" name="_method" value="PUT">
                        <input type="hidden" name="_model_class" value="status">
                        <div class="table-responsive">
                            <table class="table table-borderless table-hover table-sm">
                                <caption>
                                    <button class="btn btn-primary botao-criar botao-caption ml-3 status">Criar</button>
                                </caption>
                                <thead>
                                    <tr>
                                        <th scope="col">Código</th>
                                        <th scope="col">Nome</th>
                                        <th scope="col">Ação</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <p class="lead vazio text-center">
                                        Não há nenhum status.
                                    </p>
                                </tbody>
                            </table>
                        </div>
                    </form>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>

    <div class="row mb-4">
        <div class="col-sm">
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">Máquinas</h5>
    
                    {% if maquinas %}
                    <form action="" method="post">
                        <input type="hidden" name="_method" value="PUT">
                        <input type="hidden" name="_model_class" value="maquina">
                        <div class="table-responsive">
                            <table class="table table-borderless table-hover table-sm">
                                <caption>
                                    <button class="btn btn-primary botao-criar botao-caption maquina">Criar</button>
                                </caption>
                                <thead>
                                    <tr>
                                        <th scope="col">Nome</th>
                                        <th scope="col">Status</th>
                                        <th scope="col">Ação</th>
                                    </tr>
                                </thead>
                                <tbody>
    
                                    {% for maquina in maquinas %}
                                    <tr>
                                        <input type="hidden" class="hidden_id" name="_id" value="{{ maquina.id }}" disabled>
                                        <td>
                                            <div class="input-group">
                                                <input type="text" class="form-control" name="nome"
                                                    curvalue="{{ maquina.nome }}" value="{{ maquina.nome }}"
                                                    disabled="">
                                                <span class="input-group-append">
                                                    <i class="input-group-text bi bi-pencil-square"></i>
                                                </span>
                                            </div>
                                        </td>
    
                                        <td>
                                                <input type="text" class="form-control" value="{{ maquina.status_id }}" disabled>
                                        </td>
    
                                        <td>
                                            <button class="btn btn-danger botao-apagar w-100 {{ maquina.status_id }}">Apagar</button>
                                        </td>
                                    </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    </form>
                    {% else %}
                    <form action="" method="post">
                        <input type="hidden" name="_method" value="PUT">
                        <input type="hidden" name="_model_class" value="maquina">
                        <div class="table-responsive">
                            <table class="table table-borderless table-hover table-sm">
                                <caption>
                                    <button class="btn btn-primary botao-criar botao-caption maquina ml-3">Criar</button>
                                </caption>
                                <thead>
                                    <tr>
                                        <th scope="col">Nome</th>
                                        <th scope="col">Status</th>
                                        <th scope="col">Ação</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <p class="lead vazio text-center">
                                        Não há nenhuma máquina.
                                    </p>
                                </tbody>
                            </table>
                        </div>
                    </form>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>

    <div class="row mb-4">
        <div class="col-sm">
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">Eventos</h5>
    
                    {% if eventos %}
                        <div class="table-responsive">
                            <table class="table table-borderless table-hover table-sm">
                                <thead>
                                    <tr>
                                        <th scope="col">Status</th>
                                        <th scope="col">Máquina</th>
                                        <th scope="col">Data</th>
                                    </tr>
                                </thead>
                                <tbody>
    
                                    {% for evento in eventos %}
                                    <tr>
                                        <td>
                                           {{ evento.status_id }}
                                        </td>
    
                                        <td>
                                            {{ evento.maquina_id }}
                                        </td>
    
                                        <td>
                                            {{ evento.data }}
                                        </td>
                                    </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    </form>
                    {% else %}
                    <p class="lead vazio text-center">
                        Não há eventos.
                    </p>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>
<script src="{% static 'gerenciamento/script.js' %}"></script>
<script>
    window.addEventListener('keydown', function (e) { if (e.keyIdentifier == 'U+000A' || e.keyIdentifier == 'Enter' || e.keyCode == 13) { if (e.target.nodeName === 'INPUT' && e.target.type !== 'textarea') { e.preventDefault(); return false; } } }, true);
    if (window.history.replaceState) {
        window.history.replaceState(null, null, window.location.href);
    }
</script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css">
{% endblock %}